{******************************************************************************}
{                                                                              }
{                       Pascal Script Source File                              }
{                                                                              }
{             Run by RemObjects Pascal Script in CnPack IDE Wizards            }
{                                                                              }
{                                   Generated by CnPack IDE Wizards            }
{                                                                              }
{******************************************************************************}

program CheckZeroWidthChar;

uses
  Windows, Messages, SysUtils, Classes, Graphics, Controls, Forms, Dialogs,
  ActnList, Buttons, ClipBrd, ComCtrls, ExtCtrls, ComObj, ExtDlgs, IniFiles,
  Menus, Printers, Registry, StdCtrls, TypInfo, ToolsAPI, CnDebug,
  AsRegExpr, ScriptEvent, CnCommon, CnWizClasses, CnWizUtils, CnWizIdeUtils,
  CnWizShortCut, CnWizOptions;

var
  C: Integer;
  S: string;
begin
  S := CnOtaGetCurrentSourceFile;
  if CheckFileZeroWidthChar(S, C) then
  begin
    if C = 0 then
      InfoDlg('Current File: ' + #13#10 + S + #13#10 + 'has NO Zero-Width Chars. Seems OK.')
    else
    begin
      if QueryDlg('Current File: ' + #13#10 + S + #13#10 + 'has ' + IntToStr(C) + ' Zero-Width Char(s). '
        + #13#10#13#10 + 'Correct it?', False) then
      begin
        if CorrectFileZeroWidthChar(S, C) then
          InfoDlg('Remove Zero-Width Char(s) ' + IntToStr(C));
      end;
    end;
  end
  else
    InfoDlg('Checking NOT Supported');
end.
